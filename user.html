<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HXH 獵人揪團｜查詢</title>

<!-- 字型：標題宋體、內容黑體 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Noto+Serif+TC:wght@700;900&display=swap" rel="stylesheet">

<style>
/* =========================
   基本設定（直版面）
========================= */
body{
  margin:0;
  background:#fafafa;
  color:#222;
  font-family:'Noto Sans TC', sans-serif;
}

.wrap{
  max-width:960px;
  margin:0 auto;
  padding:20px 16px 60px;
}

/* =========================
   上方標題區（不圓角）
========================= */
.header{
  background:#0f1f3a;
  color:#fff;
  padding:20px 16px;
  text-align:center;
  margin-bottom:16px;
}

.header h1{
  margin:0 0 6px;
  font-family:'Noto Serif TC', serif;
  font-size:24px;
  font-weight:900;
}

.header p{
  margin:0;
  font-size:14px;
  opacity:.9;
}

/* =========================
   查詢區
========================= */
.search{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  margin:16px 0;
}

/* 圓角搜尋框 */
.search input{
  flex:0 1 280px;
  padding:12px 14px;
  font-size:14px;
  border-radius:999px;       /* ✅ 圓角 */
  border:1px solid #ddd;
  outline:none;
}

/* 深藍查詢按鈕 */
.search button{
  padding:12px 18px;
  border-radius:999px;
  border:none;
  background:#0f1f3a;
  color:#fff;
  font-weight:800;
  cursor:pointer;
}

.search button:disabled{
  opacity:.6;
  cursor:default;
}

/* =========================
   查詢中提示（深藍）
========================= */
.loading{
  text-align:center;
  font-weight:800;
  color:#0f1f3a;
  margin:12px 0;
}

/* =========================
   Tabs
========================= */
.tabs{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:16px 0;
}

.tab{
  padding:8px 14px;
  border-radius:999px;
  border:1px solid #ddd;
  background:#fff;
  font-size:13px;
  font-weight:800;
  cursor:pointer;
}

.tab.active{
  background:#f5c451;
  border-color:#f5c451;
}

/* =========================
   表格（手機左右滑）
========================= */
.table-wrap{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}

table{
  width:100%;
  min-width:900px;
  border-collapse:collapse;
  background:#fff;
  border:1px solid #ddd;
}

th,td{
  padding:10px;
  border-bottom:1px solid #eee;
  font-size:14px;
  text-align:left;
}

th{
  background:#f2f3f5;
  font-weight:900;
}

/* 狀態標籤 */
.badge{
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:900;
}

.paid{ background:#e6f4ea; color:#1b5e20; }
.unpaid{ background:#fdecea; color:#a40000; }
</style>
</head>

<body>
<div class="wrap">

  <!-- 標題 -->
  <div class="header">
    <h1>HXH 獵人揪團</h1>
    <p>查詢你的訂單與付款狀態</p>
  </div>

  <!-- 查詢 -->
  <div class="search">
    <input id="name" placeholder="暱稱（FB / LINE）">
    <input id="key" placeholder="查詢密碼">
    <button id="go">查詢</button>
  </div>

  <!-- 查詢中提示 -->
  <div id="loading" class="loading" style="display:none;">查詢中…</div>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" data-type="order">訂單明細</div>
    <div class="tab" data-type="payment">付款明細</div>
  </div>

  <!-- 結果 -->
  <div id="list"></div>

</div>

<script>
/* =========================
   ⚠️ 改成你自己的 Apps Script URL
========================= */
const API_URL = "你的 Apps Script exec URL";

/* 查詢按鈕 */
document.getElementById("go").addEventListener("click", runQuery);

async function runQuery(){
  const name = document.getElementById("name").value.trim();
  const key  = document.getElementById("key").value.trim();
  const btn  = document.getElementById("go");
  const loading = document.getElementById("loading");
  const list = document.getElementById("list");

  if(!name || !key){
    alert("請輸入暱稱與密碼");
    return;
  }

  btn.disabled = true;
  loading.style.display = "block";
  list.innerHTML = "";

  try{
    const url = `${API_URL}?q=${encodeURIComponent(name)}&key=${encodeURIComponent(key)}`;
    const res = await fetch(url);
    const data = await res.json();

    if(!data.ok) throw new Error(data.message || "查詢失敗");

    // 範例渲染（你之後可換成完整版本）
    let html = `
    <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>團別</th>
          <th>品項</th>
          <th>數量</th>
          <th>金額</th>
          <th>狀態</th>
        </tr>
      </thead>
      <tbody>
    `;

    data.details.forEach(d=>{
      const paid = String(d.pay_status).includes("已");
      html += `
        <tr>
          <td>${d.group}</td>
          <td>${d.item}</td>
          <td>${d.qty}</td>
          <td>${d.amount}</td>
          <td><span class="badge ${paid?'paid':'unpaid'}">${d.pay_status}</span></td>
        </tr>
      `;
    });

    html += "</tbody></table></div>";
    list.innerHTML = html;

  }catch(err){
    list.innerHTML = `<div class="loading" style="color:#a40000;">${err.message}</div>`;
  }finally{
    btn.disabled = false;
    loading.style.display = "none";
  }
}
</script>

</body>
</html>
